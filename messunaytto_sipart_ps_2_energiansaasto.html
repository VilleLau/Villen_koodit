<!doctype html>
<html lang="fi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SIPART PS2 – Energiatehokas asennoitin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      html,body{height:100%}
      .gradient{background: radial-gradient(1200px 600px at 20% -10%, rgba(59,130,246,.25), transparent 60%),
                           radial-gradient(900px 480px at 90% 110%, rgba(16,185,129,.25), transparent 60%),
                           linear-gradient(180deg, #0b1220, #0a0f1a)}
      .shine{position:relative;overflow:hidden}
      .shine::after{content:"";position:absolute;inset:-40%;background:conic-gradient(from 0deg, transparent 0 340deg, rgba(255,255,255,.06) 340deg 360deg);animation:spin 18s linear infinite}
      @keyframes spin{to{transform:rotate(1turn)}}
    </style>
  </head>
  <body class="gradient text-slate-100">
    <!-- Safe area for 16:9 screens -->
    <div class="mx-auto max-w-[1700px] min-h-screen flex flex-col p-6 md:p-10">

      <!-- Header / Brand strip -->
      <header class="flex items-center justify-between gap-6 pb-4 border-b border-white/10">
        <div class="flex items-center gap-4">
          <!-- Simple gear + pulse SVG logo placeholder -->
          <svg width="44" height="44" viewBox="0 0 24 24" fill="none" class="shrink-0">
            <path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41" stroke="currentColor" stroke-width="1.2" opacity=".5"/>
            <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="12" cy="12" r="2" fill="currentColor"/>
          </svg>
          <div>
            <p class="text-xs uppercase tracking-widest text-slate-400">Näyttö messuille</p>
            <h1 class="text-2xl md:text-4xl font-semibold leading-tight">SIPART PS2 – energiatehokas asennoitin</h1>
          </div>
        </div>
        <!-- QR block -->
        <div class="hidden md:flex items-center gap-3">
          <div class="p-2 rounded-xl bg-white/5">
            <!-- Simple QR placeholder -->
            <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
              <rect width="80" height="80" rx="10" fill="white" fill-opacity=".06"/>
              <rect x="8" y="8" width="16" height="16" fill="white"/>
              <rect x="56" y="8" width="16" height="16" fill="white"/>
              <rect x="8" y="56" width="16" height="16" fill="white"/>
              <rect x="32" y="32" width="8" height="8" fill="white"/>
              <rect x="44" y="44" width="8" height="8" fill="white"/>
              <rect x="56" y="56" width="8" height="8" fill="white"/>
              <rect x="24" y="48" width="8" height="8" fill="white"/>
            </svg>
          </div>
          <div class="text-right">
            <p class="text-sm font-medium">Lisätiedot / datasivu</p>
            <p class="text-xs text-slate-400">Skannaa QR tai käy: <span class="underline">yrityksenne-URL</span></p>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button id="btnPresent" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15 text-sm">Esitystila: pois</button>
        </div>
      </header>

      <!-- Hero metric band -->
      <section class="grid grid-cols-1 lg:grid-cols-4 gap-4 mt-6">
        <div class="col-span-1 lg:col-span-2 rounded-2xl p-6 shine bg-white/5 border border-white/10">
          <div class="mb-3 flex items-center justify-between gap-4">
            <p class="text-slate-300 text-sm">Sähkön & paineilman säästö (esimerkki)</p>
            <div class="text-right">
              <p class="text-xs text-slate-400">Tänä vuonna säästöt tähän mennessä</p>
              <div id="euroTicker" class="text-2xl md:text-3xl font-semibold tabular-nums">0 €</div>
            </div>
          </div>
          <p class="text-slate-300 text-sm">Sähkön & paineilman säästö (esimerkki)</p>
          <div class="mt-1 flex items-end gap-4">
            <div>
              <div id="counterSaved" class="text-5xl md:text-7xl font-bold tabular-nums">0</div>
              <div class="text-slate-400">kWh/vuosi*</div>
            </div>
            <div class="text-emerald-300/90 text-lg md:text-2xl font-medium">−<span id="percentSaved">0</span>% kulutus</div>
          </div>
          <p class="mt-3 text-xs text-slate-400">*Laskentaesimerkki 6 bar instrumenttiilma, 200 venttiiliä, tyypillinen prosessi. Muokkaa omiin arvoihisi.</p>
        </div>
        <div class="rounded-2xl p-6 bg-white/5 border border-white/10">
          <p class="text-slate-300 text-sm">Virtauksen hallinta</p>
          <p class="mt-1 text-xl">Tarkka asento-ohjaus & itseoppiva viritys</p>
          <ul class="mt-3 space-y-1 text-sm text-slate-300 list-disc list-inside">
            <li>Alhainen paineilman kulutus</li>
            <li>Laaja diagnostiikka (HART/PA/PROFIBUS*)</li>
            <li>Partial Stroke Test -valmius*</li>
          </ul>
          <p class="mt-2 text-xs text-slate-500">*Riippuu kokoonpanosta/versiosta</p>
        </div>
        <div class="rounded-2xl p-6 bg-white/5 border border-white/10">
          <p class="text-slate-300 text-sm">Takaisinmaksu</p>
          <div class="mt-1 text-3xl md:text-4xl font-bold"><span id="paybackMonths">–</span> kk</div>
          <p class="mt-2 text-sm text-slate-300">Esimerkin mukaan 6–18 kk kokoonpanosta riippuen.</p>
        </div>
      </section>

      <!-- Controls: Live calculator -->
      <section id="controls" class="mt-6 grid grid-cols-1 lg:grid-cols-12 gap-4">
        <!-- Big quantity card -->
        <div class="lg:col-span-4 rounded-2xl p-6 bg-white/5 border border-white/10 flex flex-col justify-between">
          <div>
            <p class="text-slate-300 text-sm">Kappalemäärä (venttiilit)</p>
            <div class="mt-2 flex items-end gap-3">
              <div id="qtyBig" class="text-6xl md:text-7xl font-bold tabular-nums">200</div>
              <span class="text-slate-400 mb-3">kpl</span>
            </div>
          </div>
          <div class="mt-4 flex items-center gap-2">
            <button id="minusQty" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15">−10</button>
            <input id="inpValves" type="number" min="1" max="5000" step="1" class="w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
            <button id="plusQty" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15">+10</button>
          </div>
        </div>

        <!-- Hours & electricity price -->
        <div class="lg:col-span-4 rounded-2xl p-6 bg-white/5 border border-white/10 grid grid-cols-2 gap-4">
          <div>
            <label class="text-slate-300 text-sm">Tunnit vuodessa</label>
            <input id="inpHours" type="number" min="0" max="8760" step="100" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
          <div>
            <label class="text-slate-300 text-sm">Sähkön hinta (€/kWh)</label>
            <input id="inpPrice" type="number" min="0" max="5" step="0.01" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
          <div>
            <label class="text-slate-300 text-sm">Kompressorin ominaissähkö (kWh/Nm³)</label>
            <input id="inpSE" type="number" min="0.01" max="1" step="0.01" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
        </div>

        <!-- Air consumption inputs -->
        <div class="lg:col-span-4 rounded-2xl p-6 bg-white/5 border border-white/10 grid grid-cols-1 gap-3">
          <div>
            <label class="text-slate-300 text-sm">SIPART PS2 (Nl/min)</label>
            <input id="inpPS2" type="number" min="0.1" max="50" step="0.1" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
          <div>
            <label class="text-slate-300 text-sm">Kilpailija A (Nl/min)</label>
            <input id="inpA" type="number" min="0.1" max="50" step="0.1" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
          <div>
            <label class="text-slate-300 text-sm">Kilpailija B (Nl/min)</label>
            <input id="inpB" type="number" min="0.1" max="50" step="0.1" class="mt-2 w-full px-3 py-2 rounded-xl bg-white/10 focus:outline-none"/>
          </div>
        </div>
      </section>

      <!-- Comparison: PS2 vs kilpailija -->
      <section class="mt-8 grid grid-cols-1 xl:grid-cols-2 gap-6">
        <div class="rounded-2xl p-6 bg-white/5 border border-white/10">
          <h2 class="text-xl md:text-2xl font-semibold mb-4">Paineilman kulutus
            <span class="text-sm font-normal text-slate-400">(norm. käyttötilanne)</span>
          </h2>
          <!-- Bars -->
          <div class="space-y-4">
            <div>
              <div class="flex justify-between text-sm"><span>SIPART PS2</span><span id="ps2Val">0</span> Nl/min</div>
              <div class="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                <div id="ps2Bar" class="h-3 bg-emerald-400/80" style="width:0%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between text-sm"><span>Kilpailija A</span><span id="compAVal">0</span> Nl/min</div>
              <div class="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                <div id="compABar" class="h-3 bg-sky-400/80" style="width:0%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between text-sm"><span>Kilpailija B</span><span id="compBVal">0</span> Nl/min</div>
              <div class="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                <div id="compBBar" class="h-3 bg-indigo-400/80" style="width:0%"></div>
              </div>
            </div>
          </div>
          <p class="mt-3 text-xs text-slate-400">Arvot ovat muokattavia. Syötä messutilanteessa asiakaskohtaiset luvut (näppäimistö-koodit alla).</p>
        </div>

        <!-- Slide carousel: key messages -->
        <div class="rounded-2xl p-0 border border-white/10 overflow-hidden">
          <div id="slides" class="relative h-[320px] md:h-[380px]">
            <div class="absolute inset-0 p-6 flex flex-col justify-center gap-3 slide">
              <h3 class="text-2xl font-semibold">Miksi SIPART PS2?</h3>
              <ul class="text-lg leading-relaxed text-slate-200 list-disc list-inside">
                <li>Alhainen energian- ja paineilman kulutus</li>
                <li>Laaja itse-diagnostiikka ja kunnonvalvonta</li>
                <li>Modulaarinen – soveltuu läppä-, pallo- ja istukkaventtiileille</li>
                <li>Helppo käyttöönotto – automaattiviritys</li>
              </ul>
            </div>
            <div class="absolute inset-0 p-6 hidden flex-col justify-center gap-3 slide">
              <h3 class="text-2xl font-semibold">Tyypillinen säästö</h3>
              <p class="text-lg">Esimerkki: 200 venttiiliä, 8 000 h/a, sähkön hinta 0,10 €/kWh</p>
              <div class="grid grid-cols-2 gap-4 mt-2">
                <div class="rounded-xl bg-white/5 p-4">
                  <p class="text-sm text-slate-300">Säästö paineilmakompressorin sähkössä</p>
                  <p class="text-3xl font-bold">≈ <span id="euroSaved">0</span> €/a</p>
                </div>
                <div class="rounded-xl bg-white/5 p-4">
                  <p class="text-sm text-slate-300">CO₂-vähennys (scope 2)</p>
                  <p class="text-3xl font-bold">≈ <span id="co2Saved">0</span> kg/a</p>
                </div>
              </div>
              <p class="text-xs text-slate-400 mt-2">CO₂-laskennassa esimerkkikerroin 150 g/kWh.</p>
            </div>
            <div class="absolute inset-0 p-6 hidden flex-col justify-center gap-3 slide">
              <h3 class="text-2xl font-semibold">Integraatio & protokollat</h3>
              <p class="text-lg">HART | Profibus PA | Foundation Fieldbus | 4–20 mA</p>
              <p class="text-slate-300">Kunnonvalvonnan tilat ja hälytykset ohjaukseen – parantaa käytettävyyttä.</p>
            </div>
            <div class="absolute inset-0 p-6 hidden flex-col justify-center gap-3 slide">
              <h3 class="text-2xl font-semibold">Turvallisuus & testattavuus</h3>
              <p class="text-lg">Partial Stroke Test (PST) -ominaisuus saatavilla – mahdollistaa venttiilin jumiutumisen havaitsemisen.</p>
              <p class="text-slate-300">Valmius SIL-sovelluksiin kokoonpanosta riippuen.</p>
            </div>
          </div>
          <div class="flex items-center justify-between px-4 py-2 bg-white/5 text-xs text-slate-300">
            <div>Automaattinen kierto • Paina <kbd class="px-1 py-0.5 rounded bg-white/10">Space</kbd> tauko/jatka</div>
            <div class="flex gap-1" id="dots"></div>
          </div>
        </div>
      </section>

      <!-- Footer notes -->
      <footer class="mt-6 text-[13px] text-slate-400 flex flex-wrap items-center justify-between gap-3">
        <div>© Näyttöesimerkki. Päivitä arvot ennen messuja. Kaikki luvut esimerkinomaisia.</div>
        <div>Näppäinyhdistelmät: <span class="font-medium text-slate-200">E</span>=energia, <span class="font-medium text-slate-200">A</span>=kilpailija A, <span class="font-medium text-slate-200">B</span>=kilpailija B, <span class="font-medium text-slate-200">P</span>=PS2 arvo, <span class="font-medium text-slate-200">R</span>=reset</div>
      </footer>
    </div>

    <script>
      // --- Editable defaults (esimerkit) ---
      const data = {
        ps2NlMin: 2.0,    // SIPART PS2 tyypillinen kulutus (esimerkkiluku)
        compANlMin: 5.0,  // Kilpailija A (esimerkkiluku)
        compBNlMin: 7.5,  // Kilpailija B (esimerkkiluku)
        valves: 200,
        hoursPerYear: 8000,
        kWhPerNm3Air: 0.1, // Kompressorin ominaissähkö (kWh / Nm³) ~ ohjearvo
        electricityPrice: 0.12, // €/kWh
        co2Factor: 0.150 // kg/kWh
      }

      // --- Helpers ---
      const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
      const animateNumber = (el, to, dur=1000, unit="") => {
        const from = Number(el.textContent.replace(/[^0-9.-]/g, "")) || 0;
        const start = performance.now();
        const step = now => {
          const t = clamp((now - start) / dur, 0, 1);
          const val = from + (to - from) * (1 - Math.pow(1 - t, 3)); // easeOutCubic
          el.textContent = Math.round(val).toLocaleString("fi-FI");
          if (t < 1) requestAnimationFrame(step);
        };
        requestAnimationFrame(step);
      };

      function recalc() {
        // Lasketaan kulutuksesta säästöjä
        const avgNlMin = (data.compANlMin + data.compBNlMin) / 2;
        const savedNlMinPerValve = Math.max(0, avgNlMin - data.ps2NlMin);
        const savedNm3hPerValve = (savedNlMinPerValve * 60) / 1000;
        const savedKWhPerValveYear = savedNm3hPerValve * data.hoursPerYear * data.kWhPerNm3Air;
        const totalSavedKWh = savedKWhPerValveYear * data.valves;

        // Eurot ja CO2
        const euros = totalSavedKWh * data.electricityPrice;
        const co2 = totalSavedKWh * data.co2Factor * 1000; // kg

        // Prosenttisäästö vs. CompA keskiarvoon nähden
        const percent = avgNlMin > 0 ? ((avgNlMin - data.ps2NlMin) / avgNlMin) * 100 : 0;

        // Payback: oletetaan asennoittimen lisähintaero 150€ / venttiili (esimerkki)
        const deltaCostPerValve = 150; 
        const paybackYears = deltaCostPerValve / (savedKWhPerValveYear * data.electricityPrice || 1);
        const paybackMonths = paybackYears * 12;

        // Päivitä UI (animoiden)
        animateNumber(document.getElementById('counterSaved'), totalSavedKWh);
        animateNumber(document.getElementById('euroSaved'), euros);
        animateNumber(document.getElementById('co2Saved'), co2);
        document.getElementById('percentSaved').textContent = Math.max(0, Math.round(percent));
        document.getElementById('paybackMonths').textContent = isFinite(paybackMonths) ? Math.max(1, Math.round(paybackMonths)) : '–';
        // store annuals for ticker
        data.annualKWh = totalSavedKWh;
        data.annualEuros = euros;

        // Bars
        const maxNl = Math.max(data.ps2NlMin, data.compANlMin, data.compBNlMin);
        const ps2Pct = (data.ps2NlMin / maxNl) * 100;
        const aPct = (data.compANlMin / maxNl) * 100;
        const bPct = (data.compBNlMin / maxNl) * 100;
        document.getElementById('ps2Bar').style.width = ps2Pct + '%';
        document.getElementById('compABar').style.width = aPct + '%';
        document.getElementById('compBBar').style.width = bPct + '%';
        document.getElementById('ps2Val').textContent = data.ps2NlMin.toFixed(2);
        document.getElementById('compAVal').textContent = data.compANlMin.toFixed(2);
        document.getElementById('compBVal').textContent = data.compBNlMin.toFixed(2);
      }

      // --- Bind inputs for live calculator ---
      function setVal(id, v){ const el = document.getElementById(id); if(el) el.value = v; }
      function bindNumber(id, setter){
        const el = document.getElementById(id);
        if(!el) return;
        const handler = ()=>{ const v = parseFloat(el.value); if(!isNaN(v)) { setter(v); recalc(); }};
        el.addEventListener('input', handler);
        el.addEventListener('change', handler);
      }

      function syncInputs(){
        setVal('inpValves', data.valves);
        setVal('inpHours', data.hoursPerYear);
        setVal('inpPrice', data.electricityPrice);
        setVal('inpSE', data.kWhPerNm3Air);
        setVal('inpPS2', data.ps2NlMin);
        setVal('inpA', data.compANlMin);
        setVal('inpB', data.compBNlMin);
        const qty = document.getElementById('qtyBig'); if(qty) qty.textContent = data.valves.toLocaleString('fi-FI');
      }

      bindNumber('inpValves', v=>{ data.valves = clamp(v,1,5000); const qty = document.getElementById('qtyBig'); if(qty) qty.textContent = Math.round(data.valves).toLocaleString('fi-FI'); });
      bindNumber('inpHours', v=> data.hoursPerYear = clamp(v,0,8760));
      bindNumber('inpPrice', v=> data.electricityPrice = clamp(v,0,5));
      bindNumber('inpSE', v=> data.kWhPerNm3Air = clamp(v,0.01,1));
      bindNumber('inpPS2', v=> data.ps2NlMin = clamp(v,0.1,50));
      bindNumber('inpA', v=> data.compANlMin = clamp(v,0.1,50));
      bindNumber('inpB', v=> data.compBNlMin = clamp(v,0.1,50));

      const minusBtn = document.getElementById('minusQty');
      const plusBtn = document.getElementById('plusQty');
      if(minusBtn){ minusBtn.addEventListener('click', ()=>{ data.valves = clamp(Math.round(data.valves-10),1,5000); syncInputs(); recalc(); }); }
      if(plusBtn){ plusBtn.addEventListener('click', ()=>{ data.valves = clamp(Math.round(data.valves+10),1,5000); syncInputs(); recalc(); }); }

      // --- Slides ---
      const slides = Array.from(document.querySelectorAll('#slides .slide'));
      const dotsWrap = document.getElementById('dots');
      let idx = 0, paused = false, timer = null;

      function renderDots(){
        dotsWrap.innerHTML = '';
        slides.forEach((_, i)=>{
          const b = document.createElement('button');
          b.className = 'w-2.5 h-2.5 rounded-full ' + (i===idx? 'bg-white' : 'bg-white/30');
          b.addEventListener('click', ()=>{ idx = i; showSlide();});
          dotsWrap.appendChild(b);
        });
      }

      function showSlide(){
        slides.forEach((el, i)=>{ el.classList.toggle('hidden', i!==idx); });
        renderDots();
      }

      function nextSlide(){ idx = (idx + 1) % slides.length; showSlide(); }
      function startAuto(){ if (timer) clearInterval(timer); timer = setInterval(()=>{ if(!paused) nextSlide(); }, 8000); }

      // --- Keyboard quick-edit for live demo ---
      // E: edit energy/euros inputs quickly via prompt, P/A/B to edit Nl/min
      window.addEventListener('keydown', (e)=>{
        if(e.key===' '){ paused = !paused; e.preventDefault(); return; }
        if(['E','e'].includes(e.key)){
          const price = parseFloat(prompt('Sähkön hinta €/kWh', data.electricityPrice));
          if(!isNaN(price)) data.electricityPrice = clamp(price, 0, 5);
          const factor = parseFloat(prompt('Kompressorin ominaissähkö (kWh/Nm³)', data.kWhPerNm3Air));
          if(!isNaN(factor)) data.kWhPerNm3Air = clamp(factor, 0.01, 1);
          const valves = parseInt(prompt('Venttiilien lukumäärä', data.valves));
          if(!isNaN(valves)) data.valves = clamp(valves, 1, 5000);
          recalc();
        }
        if(['P','p'].includes(e.key)){
          const v = parseFloat(prompt('PS2 kulutus (Nl/min)', data.ps2NlMin));
          if(!isNaN(v)) data.ps2NlMin = clamp(v, 0.1, 50);
          recalc();
        }
        if(['A','a'].includes(e.key)){
          const v = parseFloat(prompt('Kilpailija A kulutus (Nl/min)', data.compANlMin));
          if(!isNaN(v)) data.compANlMin = clamp(v, 0.1, 50);
          recalc();
        }
        if(['B','b'].includes(e.key)){
          const v = parseFloat(prompt('Kilpailija B kulutus (Nl/min)', data.compBNlMin));
          if(!isNaN(v)) data.compBNlMin = clamp(v, 0.1, 50);
          recalc();
        }
        if(['R','r'].includes(e.key)){
          Object.assign(data, { ps2NlMin: 2.0, compANlMin: 5.0, compBNlMin: 7.5, valves: 200, hoursPerYear: 8000, kWhPerNm3Air: 0.1, electricityPrice: 0.10, co2Factor: 0.150 });
          recalc();
        }
      });

      // Init
      recalc();
      showSlide();
      startAuto();

      // --- Presentation mode toggle & Euro ticker ---
      let presentation = false;
      function setPresentation(b){
        presentation = !!b;
        const ctrls = document.getElementById('controls');
        if(ctrls) ctrls.classList.toggle('hidden', presentation);
        const btn = document.getElementById('btnPresent');
        if(btn) btn.textContent = 'Esitystila: ' + (presentation ? 'päällä' : 'pois');
      }
      const btn = document.getElementById('btnPresent');
      if(btn) btn.addEventListener('click', ()=> setPresentation(!presentation));
      window.addEventListener('keydown', (e)=>{ if(['H','h'].includes(e.key)){ setPresentation(!presentation); }});

      function yearFraction(){
        const now = new Date();
        const start = new Date(now.getFullYear(),0,1);
        const end = new Date(now.getFullYear()+1,0,1);
        return (now - start) / (end - start);
      }
      function renderEuroTicker(){
        const el = document.getElementById('euroTicker'); if(!el) return;
        const val = (data.annualEuros||0) * yearFraction();
        try{ el.textContent = val.toLocaleString('fi-FI',{style:'currency',currency:'EUR',maximumFractionDigits:0}); }
        catch{ el.textContent = Math.round(val).toLocaleString('fi-FI') + ' €'; }
      }
      setInterval(renderEuroTicker,1000);
      renderEuroTicker();
    </script>
  </body>
</html>
